## Chapter 7 深入IO

### IOStream概述

- IOStream采用流式I/O而非记录I/O，但可以在此基础上引入结构信息

- 所处理的两个主要问题
  - 表示形式的变化：使用格式化/解析在数据的内部表示与字符序列之间转换
  - 与外部设备的通信：针对不同的外部设备（终端、文件、内存）引入不同的处理逻辑
  
- 所涉及到的操作（输出流序列）
  - 格式化/解析
  - 缓存
  - 编码转换
  - 传输
  
- 采用模板来封装字符特性，采用继承来封装设备特性
  - 常用的类型实际上是类模板实例化的结果
  
    ```c++
    #include <fstream>
    std::ifstream x;
    ```

### 输入与输出

- 输入与输出分为格式化和非格式化两类

- 非格式化I/O：不涉及数据表示行驶的变化

  - 常用输入函数：`get / read / getline / gcount`
  - 常用输出函数：`put / write`

- 格式化I/O：使用移位操作符来进行输入（>>）与输出（<<）

  - c++通过操作符重载以支持内建数据类型的格式化I/O
  - 可以通过重载操作符以支持自定义类型的格式化I/O

- 格式控制

  - 可以接收位掩码类型（showpos）、字符类型（fill）与取值相对随意（width）的格式化参数

    - ```c++
      std::cout.setf(std::ios_base::showpos); // 输出如果是正数，自动加正号
      std::cout<< x <<std::endl;
      std::cout.width(10); // 输出10个字符，不足10个的，前面用空格替代.
      std::cout.fill('.'); // 用'.'替代上一条语句中设定的空格
      ```

  - 注意width方法的特殊性：触发后被重置

- 操作符

  - 简化格式化参数的设置
  - 触发实际的插入与提取操作

- 提取会放松对格式的限制

- 提取C风格字符串时要小心内存越界

### 操作符

- ```c++
  #include <iomanip>
  cout<< showpos << setw(10) << setfill('.') << x;
  ```

- 

- `cout<< showpos << x;`





































